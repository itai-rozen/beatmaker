{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\\\u05D0\\u05D9\\u05EA\\u05D9\\\\Downloads\\\\go local\\\\react\\\\beatmaker\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:\\\\Users\\\\\\u05D0\\u05D9\\u05EA\\u05D9\\\\Downloads\\\\go local\\\\react\\\\beatmaker\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:\\\\Users\\\\\\u05D0\\u05D9\\u05EA\\u05D9\\\\Downloads\\\\go local\\\\react\\\\beatmaker\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{Provider}from'./components/Context';import useSound from'use-sound';import notes from'./../src/sounds/all-instruments.mp3';import'./App.css';import Main from'./components/Main/Main.js';function App(){// creating the scale & beat constants\nvar BEATS=16;var SCALES=['C2','D2','E2','G2','C3','D3','E3','G3','C4','D4','E4'];// creating the BeatBar \nvar getBeatCpts=function getBeatCpts(){var beatCpts=[];for(var i=0;i<BEATS;i++){beatCpts.push(i);}return beatCpts;};var beatCpts=getBeatCpts();// creating the SoundBoard\nvar getSoundPoints=function getSoundPoints(){var sounds=[];for(var i=0;i<SCALES.length;i++){sounds.push([]);for(var j=0;j<BEATS;j++){sounds[i].push({i:i,j:j,scale:SCALES[i],activeInstruments:{}});}}return sounds;};// assigning names and intervals for the sounds in the mp3 file\nvar getSprites=function getSprites(){var count=-1000;var sprites={};instruments.forEach(function(instrument){SCALES.forEach(function(scale){sprites[instrument.name+scale]=[count+=1000,1000];});});return sprites;};// initializing some varibales with HOOKS\nvar _useState=useState(getSoundPoints()),_useState2=_slicedToArray(_useState,2),sounds=_useState2[0],setSounds=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),activeSounds=_useState4[0],setActiveSounds=_useState4[1];var _useState5=useState(-1),_useState6=_slicedToArray(_useState5,2),redBeatIndex=_useState6[0],setRedBeatIndex=_useState6[1];// const [render, setRender] = useState(0)\nvar _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),initialState=_useState8[0],setInitialState=_useState8[1];var _useState9=useState([{name:'saxophone',checked:true},{name:'cello',checked:false},{name:'oboe',checked:false},{name:'vocal',checked:false},{name:'guitar',checked:false},{name:'kora',checked:false},{name:'vibraphone',checked:false},{name:'drums',checked:false},{name:'violin',checked:false}]),_useState10=_slicedToArray(_useState9,2),instruments=_useState10[0],setInstruments=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isShowSave=_useState12[0],setIsShowSave=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isShowLoad=_useState14[0],setIsShowLoad=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),isPlay=_useState16[0],setIsPlay=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),isPause=_useState18[0],setIsPause=_useState18[1];var _useState19=useState(1000),_useState20=_slicedToArray(_useState19,2),delay=_useState20[0],setDelay=_useState20[1];var _useState21=useState(60),_useState22=_slicedToArray(_useState21,2),tempo=_useState22[0],setTempo=_useState22[1];var _useState23=useState(0.75),_useState24=_slicedToArray(_useState23,2),volume=_useState24[0],setVolume=_useState24[1];// the useSound HOOK !!\nvar _useSound=useSound(notes,{volume:volume,sprite:getSprites(),interrupt:false}),_useSound2=_slicedToArray(_useSound,1),play=_useSound2[0];// functions for the Instrument Bar\nvar checkInstrument=function checkInstrument(name){setInstruments(instruments.map(function(instrument){return instrument.name===name?_objectSpread(_objectSpread({},instrument),{},{checked:true}):_objectSpread(_objectSpread({},instrument),{},{checked:false});}));};// functions for the Beat Bar\nvar assignColor=function assignColor(i){if(!isPlay&&!isPause)return;return i===redBeatIndex?'red':'';};// functions for the Sound Board\nvar handleClickedSound=function handleClickedSound(i,j,instrument){setSounds(sounds.map(function(soundRow){return soundRow.map(function(sound){return sound.i===i&&sound.j===j?_objectSpread(_objectSpread({},sound),{},{activeInstruments:_objectSpread(_objectSpread({},sound.activeInstruments),{},_defineProperty({},instrument,!sound.activeInstruments[instrument]))}):sound;});}));};var assignSoundClass=function assignSoundClass(i,j,instrument){var currSoundInstrument=sounds[i][j].activeInstruments[instrument];return currSoundInstrument===true?'active':'';};// const toggleMute = () => {\n//   console.log('let mute!')\n//   let volumeSliderValue = document.getElementById('volume-slider').value\n//   if (volumeSliderValue !== 0) {\n//     volumeSliderValue = 0\n//     document.querySelector('.mute').classList.remove('hidden')\n//     setRender(render+1)\n//   } else {\n//     volumeSliderValue = 0.75\n//     document.querySelector('.mute').classList.add('hidden')\n//     setRender(render+1)\n//   }\n// }\nvar playSounds=function playSounds(){if(isPlay){var currentActives=activeSounds.filter(function(sound){return sound.j===redBeatIndex;});// console.log('current actives: ',currentActives)\ncurrentActives.forEach(function(sound){for(var instrument in sound.activeInstruments){// console.log('instrument status: ', sound.activeInstruments[instrument])\nif(sound.activeInstruments[instrument]===true)play({id:instrument+sound.scale});}});}};// USE EFFECT! all the stuff that renders on each change of the usestates in the brackets below\nuseEffect(function(){var actives=[];sounds.forEach(function(soundRow){return soundRow.forEach(function(sound){for(var instrument in sound.activeInstruments){if(sound.activeInstruments[instrument])actives.push(sound);}});});setActiveSounds(actives);// fetch('/api')\n// .then(res=> {\n//   if(res.ok){\n//     return res.json()\n//   }\n// }).then(jsonResponse => {\n//   setInitialState(jsonResponse)\n// })\n// .catch(err => console.error(err))\nconsole.log('initial state: ',initialState);console.log('active sounds @ useeffect: ',activeSounds);playSounds();},[redBeatIndex,isPlay,isShowLoad,isShowSave]);// initializing the increment  with useRef (otherwise setInterval wont work properly)\nvar increment=useRef(null);// functions for the Control Buttons Bar\nvar startPlaying=function startPlaying(){if(isPlay)return;setIsPlay(true);setIsPause(false);increment.current=setInterval(function(){setRedBeatIndex(function(redBeatIndex){return redBeatIndex===15?0:redBeatIndex+1;});},delay);};var pausePlaying=function pausePlaying(){if(!isPlay)return;clearInterval(increment.current);setIsPlay(false);setIsPause(true);};var stopPlaying=function stopPlaying(){clearInterval(increment.current);setIsPlay(false);setIsPause(false);setRedBeatIndex(-1);};var resetPlaying=function resetPlaying(){clearInterval(increment.current);setIsPlay(false);setIsPause(false);setRedBeatIndex(-1);setDelay(1000);setTempo(60);document.getElementById('tempo-slider').value=60;document.getElementById('volume-slider').value=0.75;setVolume(0.75);setSounds(getSoundPoints());setActiveSounds([]);};var clearInstrument=function clearInstrument(){var currentInsrtumentName=instruments.filter(function(instrument){return instrument.checked;})[0].name;setSounds(sounds.map(function(soundRow){return soundRow.map(function(sound){return sound.activeInstruments[currentInsrtumentName]?_objectSpread(_objectSpread({},sound),{},{activeInstruments:_objectSpread(_objectSpread({},sound.activeInstruments),{},_defineProperty({},currentInsrtumentName,false))}):sound;});}));};var handleTempo=function handleTempo(ev){var value=ev.target.value;setTempo(value);setDelay(60/value*1000);};var handleVolume=function handleVolume(ev){if(isPlay)setVolume(ev.target.value);};var playUpdateTempo=function playUpdateTempo(){if(!isPlay)return;clearInterval(increment.current);increment.current=setInterval(function(){setRedBeatIndex(function(redBeatIndex){return redBeatIndex===15?0:redBeatIndex+1;});},delay);};// functions for saving & loading modals in the Control Buttons Bar\nvar toggleSaveModal=function toggleSaveModal(){fetch('/api').then(function(res){if(res.ok){return res.json();}}).then(function(jsonResponse){setInitialState(jsonResponse);}).catch(function(err){return console.error(err);});setIsShowSave(!isShowSave);if(isShowSave)setIsShowLoad(false);};var toggleLoadModal=function toggleLoadModal(){fetch('/api').then(function(res){if(res.ok){return res.json();}}).then(function(jsonResponse){setInitialState(jsonResponse);}).catch(function(err){return console.error(err);});setIsShowLoad(!isShowLoad);if(isShowLoad)setIsShowSave(false);};var loadSounds=function loadSounds(snds,tmpo){var parsedSounds=JSON.parse(snds);setSounds(parsedSounds);setTempo(tmpo);setDelay(60/tmpo*1000);toggleLoadModal();};return/*#__PURE__*/React.createElement(Provider,{value:{beatCpts:beatCpts,delay:delay,initialState:initialState,instruments:instruments,isShowLoad:isShowLoad,isShowSave:isShowSave,tempo:tempo,sounds:sounds,redBeatIndex:redBeatIndex,volume:volume,actions:{assignColor:assignColor,checkInstrument:checkInstrument,clearInstrument:clearInstrument,handleClickedSound:handleClickedSound,handleTempo:handleTempo,handleVolume:handleVolume,loadSounds:loadSounds,startPlaying:startPlaying,stopPlaying:stopPlaying,toggleLoadModal:toggleLoadModal,toggleSaveModal:toggleSaveModal,pausePlaying:pausePlaying,playUpdateTempo:playUpdateTempo,resetPlaying:resetPlaying,assignSoundClass:assignSoundClass}}},/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(Main,null)));}export default App;","map":{"version":3,"sources":["C:/Users/איתי/Downloads/go local/react/beatmaker/client/src/App.js"],"names":["React","useState","useEffect","useRef","Provider","useSound","notes","Main","App","BEATS","SCALES","getBeatCpts","beatCpts","i","push","getSoundPoints","sounds","length","j","scale","activeInstruments","getSprites","count","sprites","instruments","forEach","instrument","name","setSounds","activeSounds","setActiveSounds","redBeatIndex","setRedBeatIndex","initialState","setInitialState","checked","setInstruments","isShowSave","setIsShowSave","isShowLoad","setIsShowLoad","isPlay","setIsPlay","isPause","setIsPause","delay","setDelay","tempo","setTempo","volume","setVolume","sprite","interrupt","play","checkInstrument","map","assignColor","handleClickedSound","soundRow","sound","assignSoundClass","currSoundInstrument","playSounds","currentActives","filter","id","actives","console","log","increment","startPlaying","current","setInterval","pausePlaying","clearInterval","stopPlaying","resetPlaying","document","getElementById","value","clearInstrument","currentInsrtumentName","handleTempo","ev","target","handleVolume","playUpdateTempo","toggleSaveModal","fetch","then","res","ok","json","jsonResponse","catch","err","error","toggleLoadModal","loadSounds","snds","tmpo","parsedSounds","JSON","parse","actions"],"mappings":"2mBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,MAArC,KAAmD,OAAnD,CACA,OAASC,QAAT,KAAyB,sBAAzB,CACA,MAAOC,CAAAA,QAAP,KAAqB,WAArB,CACA,MAAOC,CAAAA,KAAP,KAAkB,qCAAlB,CACA,MAAO,WAAP,CACA,MAAOC,CAAAA,IAAP,KAAiB,2BAAjB,CAGA,QAASC,CAAAA,GAAT,EAAe,CAEb;AACA,GAAMC,CAAAA,KAAK,CAAG,EAAd,CACA,GAAMC,CAAAA,MAAM,CAAG,CAAC,IAAD,CAAO,IAAP,CAAa,IAAb,CAAmB,IAAnB,CAAyB,IAAzB,CAA+B,IAA/B,CAAqC,IAArC,CAA2C,IAA3C,CAAiD,IAAjD,CAAuD,IAAvD,CAA6D,IAA7D,CAAf,CAEA;AACA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACxB,GAAIC,CAAAA,QAAQ,CAAG,EAAf,CACA,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGJ,KAApB,CAA2BI,CAAC,EAA5B,CAAgC,CAC9BD,QAAQ,CAACE,IAAT,CAAcD,CAAd,EACD,CACD,MAAOD,CAAAA,QAAP,CACD,CAND,CAQA,GAAMA,CAAAA,QAAQ,CAAGD,WAAW,EAA5B,CAEC;AAED,GAAMI,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAC3B,GAAIC,CAAAA,MAAM,CAAG,EAAb,CACA,IAAK,GAAIH,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGH,MAAM,CAACO,MAA3B,CAAmCJ,CAAC,EAApC,CAAwC,CACtCG,MAAM,CAACF,IAAP,CAAY,EAAZ,EACA,IAAK,GAAII,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGT,KAApB,CAA2BS,CAAC,EAA5B,CAAgC,CAC9BF,MAAM,CAACH,CAAD,CAAN,CAAUC,IAAV,CAAe,CACbD,CAAC,CAAEA,CADU,CACPK,CAAC,CAAEA,CADI,CACDC,KAAK,CAAET,MAAM,CAACG,CAAD,CADZ,CAEbO,iBAAiB,CAAG,EAFP,CAAf,EAID,CACF,CACD,MAAOJ,CAAAA,MAAP,CACD,CAZD,CAeA;AAEA,GAAOK,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACxB,GAAIC,CAAAA,KAAK,CAAG,CAAC,IAAb,CACA,GAAIC,CAAAA,OAAO,CAAG,EAAd,CACAC,WAAW,CAACC,OAAZ,CAAqB,SAAAC,UAAU,CAAI,CAC/BhB,MAAM,CAACe,OAAP,CAAe,SAAAN,KAAK,CAAI,CACxBI,OAAO,CAACG,UAAU,CAACC,IAAX,CAAkBR,KAAnB,CAAP,CAAoC,CAACG,KAAK,EAAI,IAAV,CAAgB,IAAhB,CAApC,CACD,CAFC,CAAF,CAGD,CAJD,EAKA,MAAOC,CAAAA,OAAP,CACD,CATD,CAWA;AA/Ca,cAiDetB,QAAQ,CAACc,cAAc,EAAf,CAjDvB,wCAiDNC,MAjDM,eAiDEY,SAjDF,8BAkD2B3B,QAAQ,CAAC,EAAD,CAlDnC,yCAkDN4B,YAlDM,eAkDQC,eAlDR,8BAmD2B7B,QAAQ,CAAC,CAAC,CAAF,CAnDnC,yCAmDN8B,YAnDM,eAmDQC,eAnDR,eAoDb;AApDa,eAqD0B/B,QAAQ,CAAC,EAAD,CArDlC,yCAqDNgC,YArDM,eAqDOC,eArDP,8BAsDyBjC,QAAQ,CAAC,CAC7C,CAAE0B,IAAI,CAAE,WAAR,CAAqBQ,OAAO,CAAE,IAA9B,CAD6C,CAE7C,CAAER,IAAI,CAAE,OAAR,CAAiBQ,OAAO,CAAE,KAA1B,CAF6C,CAG7C,CAAER,IAAI,CAAE,MAAR,CAAgBQ,OAAO,CAAE,KAAzB,CAH6C,CAI7C,CAAER,IAAI,CAAE,OAAR,CAAiBQ,OAAO,CAAE,KAA1B,CAJ6C,CAK7C,CAAER,IAAI,CAAE,QAAR,CAAkBQ,OAAO,CAAE,KAA3B,CAL6C,CAM7C,CAAER,IAAI,CAAE,MAAR,CAAgBQ,OAAO,CAAE,KAAzB,CAN6C,CAO7C,CAAER,IAAI,CAAE,YAAR,CAAsBQ,OAAO,CAAE,KAA/B,CAP6C,CAQ7C,CAAER,IAAI,CAAE,OAAR,CAAiBQ,OAAO,CAAE,KAA1B,CAR6C,CAS7C,CAAER,IAAI,CAAE,QAAR,CAAkBQ,OAAO,CAAE,KAA3B,CAT6C,CAAD,CAtDjC,0CAsDNX,WAtDM,gBAsDOY,cAtDP,gCAiEuBnC,QAAQ,CAAC,KAAD,CAjE/B,2CAiENoC,UAjEM,gBAiEMC,aAjEN,gCAkEuBrC,QAAQ,CAAC,KAAD,CAlE/B,2CAkENsC,UAlEM,gBAkEMC,aAlEN,gCAmEevC,QAAQ,CAAC,KAAD,CAnEvB,2CAmENwC,MAnEM,gBAmEEC,SAnEF,gCAoEiBzC,QAAQ,CAAC,KAAD,CApEzB,2CAoEN0C,OApEM,gBAoEGC,UApEH,gCAqEa3C,QAAQ,CAAC,IAAD,CArErB,2CAqEN4C,KArEM,gBAqECC,QArED,gCAsEa7C,QAAQ,CAAC,EAAD,CAtErB,2CAsEN8C,KAtEM,gBAsECC,QAtED,gCAuEe/C,QAAQ,CAAC,IAAD,CAvEvB,2CAuENgD,MAvEM,gBAuEEC,SAvEF,gBAyEX;AAzEW,cA0EE7C,QAAQ,CAACC,KAAD,CAAQ,CAC7B2C,MAAM,CAAEA,MADqB,CAE7BE,MAAM,CAAE9B,UAAU,EAFW,CAG7B+B,SAAS,CAAE,KAHkB,CAAR,CA1EV,wCA0ENC,IA1EM,eAgFb;AAEA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAAA3B,IAAI,CAAI,CAC9BS,cAAc,CAACZ,WAAW,CAAC+B,GAAZ,CAAgB,SAAA7B,UAAU,QAAKA,CAAAA,UAAU,CAACC,IAAX,GAAoBA,IAArB,gCAAkCD,UAAlC,MAA8CS,OAAO,CAAE,IAAvD,kCAAqET,UAArE,MAAiFS,OAAO,CAAE,KAA1F,EAAJ,EAA1B,CAAD,CAAd,CACD,CAFD,CAKA;AACA,GAAMqB,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAAA3C,CAAC,CAAI,CACvB,GAAI,CAAC4B,MAAD,EAAW,CAACE,OAAhB,CAAyB,OACzB,MAAO9B,CAAAA,CAAC,GAAKkB,YAAN,CAAqB,KAArB,CAA6B,EAApC,CACD,CAHD,CAKA;AAEA,GAAM0B,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAAC5C,CAAD,CAAIK,CAAJ,CAAOQ,UAAP,CAAsB,CAC/CE,SAAS,CACPZ,MAAM,CAACuC,GAAP,CAAW,SAAAG,QAAQ,QACjBA,CAAAA,QAAQ,CAACH,GAAT,CAAa,SAAAI,KAAK,QAAKA,CAAAA,KAAK,CAAC9C,CAAN,GAAYA,CAAZ,EAAiB8C,KAAK,CAACzC,CAAN,GAAYA,CAA9B,gCAAwCyC,KAAxC,MAA+CvC,iBAAiB,gCAAOuC,KAAK,CAACvC,iBAAb,wBAAiCM,UAAjC,CAA8C,CAACiC,KAAK,CAACvC,iBAAN,CAAwBM,UAAxB,CAA/C,EAAhE,GAAyJiC,KAA7J,EAAlB,CADiB,EAAnB,CADO,CAAT,CAKD,CAND,CAQA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAAC/C,CAAD,CAAIK,CAAJ,CAAOQ,UAAP,CAAsB,CAC7C,GAAImC,CAAAA,mBAAmB,CAAG7C,MAAM,CAACH,CAAD,CAAN,CAAUK,CAAV,EAAaE,iBAAb,CAA+BM,UAA/B,CAA1B,CACA,MAAQmC,CAAAA,mBAAmB,GAAK,IAAzB,CAAiC,QAAjC,CAA4C,EAAnD,CACD,CAHD,CAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CAEvB,GAAIrB,MAAJ,CAAY,CAEV,GAAIsB,CAAAA,cAAc,CAAGlC,YAAY,CAACmC,MAAb,CAAoB,SAAAL,KAAK,QAAIA,CAAAA,KAAK,CAACzC,CAAN,GAAYa,YAAhB,EAAzB,CAArB,CACA;AACAgC,cAAc,CAACtC,OAAf,CAAuB,SAAAkC,KAAK,CAAI,CAC9B,IAAK,GAAIjC,CAAAA,UAAT,GAAuBiC,CAAAA,KAAK,CAACvC,iBAA7B,CAAgD,CAC9C;AACA,GAAIuC,KAAK,CAACvC,iBAAN,CAAwBM,UAAxB,IAAwC,IAA5C,CAAkD2B,IAAI,CAAC,CAACY,EAAE,CAAEvC,UAAU,CAAGiC,KAAK,CAACxC,KAAxB,CAAD,CAAJ,CACnD,CACF,CALD,EAMD,CACF,CAbD,CAeA;AACAjB,SAAS,CAAC,UAAM,CACd,GAAIgE,CAAAA,OAAO,CAAG,EAAd,CACAlD,MAAM,CAACS,OAAP,CAAe,SAAAiC,QAAQ,QAAIA,CAAAA,QAAQ,CAACjC,OAAT,CAAiB,SAAAkC,KAAK,CAAI,CACnD,IAAK,GAAIjC,CAAAA,UAAT,GAAwBiC,CAAAA,KAAK,CAACvC,iBAA9B,CAAiD,CAC/C,GAAIuC,KAAK,CAACvC,iBAAN,CAAwBM,UAAxB,CAAJ,CAAyCwC,OAAO,CAACpD,IAAR,CAAa6C,KAAb,EAC1C,CACF,CAJ0B,CAAJ,EAAvB,EAKA7B,eAAe,CAACoC,OAAD,CAAf,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,OAAO,CAACC,GAAR,CAAY,iBAAZ,CAA8BnC,YAA9B,EACAkC,OAAO,CAACC,GAAR,CAAY,6BAAZ,CAA2CvC,YAA3C,EACAiC,UAAU,GACX,CApBQ,CAoBN,CAAC/B,YAAD,CAAeU,MAAf,CAAsBF,UAAtB,CAAiCF,UAAjC,CApBM,CAAT,CAyBA;AACA,GAAMgC,CAAAA,SAAS,CAAGlE,MAAM,CAAC,IAAD,CAAxB,CAEA;AACA,GAAMmE,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzB,GAAI7B,MAAJ,CAAY,OACZC,SAAS,CAAC,IAAD,CAAT,CACAE,UAAU,CAAC,KAAD,CAAV,CACAyB,SAAS,CAACE,OAAV,CAAoBC,WAAW,CAAC,UAAM,CACpCxC,eAAe,CAAC,SAACD,YAAD,QAAkBA,CAAAA,YAAY,GAAK,EAAjB,CAAsB,CAAtB,CAA0BA,YAAY,CAAG,CAA3D,EAAD,CAAf,CACD,CAF8B,CAE5Bc,KAF4B,CAA/B,CAGD,CAPD,CASA,GAAM4B,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzB,GAAI,CAAChC,MAAL,CAAa,OACbiC,aAAa,CAACL,SAAS,CAACE,OAAX,CAAb,CACA7B,SAAS,CAAC,KAAD,CAAT,CACAE,UAAU,CAAC,IAAD,CAAV,CACD,CALD,CAOA,GAAM+B,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACxBD,aAAa,CAACL,SAAS,CAACE,OAAX,CAAb,CACA7B,SAAS,CAAC,KAAD,CAAT,CACAE,UAAU,CAAC,KAAD,CAAV,CACAZ,eAAe,CAAC,CAAC,CAAF,CAAf,CACD,CALD,CAOA,GAAM4C,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzBF,aAAa,CAACL,SAAS,CAACE,OAAX,CAAb,CACA7B,SAAS,CAAC,KAAD,CAAT,CACAE,UAAU,CAAC,KAAD,CAAV,CACAZ,eAAe,CAAC,CAAC,CAAF,CAAf,CACAc,QAAQ,CAAC,IAAD,CAAR,CACAE,QAAQ,CAAC,EAAD,CAAR,CACA6B,QAAQ,CAACC,cAAT,CAAwB,cAAxB,EAAwCC,KAAxC,CAAgD,EAAhD,CACAF,QAAQ,CAACC,cAAT,CAAwB,eAAxB,EAAyCC,KAAzC,CAAiD,IAAjD,CACA7B,SAAS,CAAC,IAAD,CAAT,CACAtB,SAAS,CAACb,cAAc,EAAf,CAAT,CACAe,eAAe,CAAC,EAAD,CAAf,CACD,CAZD,CAcA,GAAMkD,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CAC5B,GAAIC,CAAAA,qBAAqB,CAAGzD,WAAW,CAACwC,MAAZ,CAAmB,SAAAtC,UAAU,QAAIA,CAAAA,UAAU,CAACS,OAAf,EAA7B,EAAqD,CAArD,EAAwDR,IAApF,CACAC,SAAS,CAACZ,MAAM,CAACuC,GAAP,CAAW,SAAAG,QAAQ,QAAIA,CAAAA,QAAQ,CAACH,GAAT,CAC9B,SAAAI,KAAK,QAAKA,CAAAA,KAAK,CAACvC,iBAAN,CAAwB6D,qBAAxB,CAAD,gCAAwDtB,KAAxD,MAA+DvC,iBAAiB,gCAAOuC,KAAK,CAACvC,iBAAb,wBAAiC6D,qBAAjC,CAAyD,KAAzD,EAAhF,GAAqJtB,KAAzJ,EADyB,CAAJ,EAAnB,CAAD,CAAT,CAID,CAND,CASA,GAAMuB,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAAAC,EAAE,CAAI,CACxB,GAAIJ,CAAAA,KAAK,CAAGI,EAAE,CAACC,MAAH,CAAUL,KAAtB,CACA/B,QAAQ,CAAC+B,KAAD,CAAR,CACAjC,QAAQ,CAAC,GAAKiC,KAAL,CAAa,IAAd,CAAR,CACD,CAJD,CAOA,GAAMM,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAAF,EAAE,CAAK,CAAC,GAAI1C,MAAJ,CAAYS,SAAS,CAACiC,EAAE,CAACC,MAAH,CAAUL,KAAX,CAAT,CAA2B,CAApE,CAEA,GAAMO,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CAC5B,GAAI,CAAC7C,MAAL,CAAa,OACbiC,aAAa,CAACL,SAAS,CAACE,OAAX,CAAb,CACAF,SAAS,CAACE,OAAV,CAAoBC,WAAW,CAAC,UAAM,CACpCxC,eAAe,CAAC,SAACD,YAAD,QAAkBA,CAAAA,YAAY,GAAK,EAAjB,CAAsB,CAAtB,CAA0BA,YAAY,CAAG,CAA3D,EAAD,CAAf,CACD,CAF8B,CAE5Bc,KAF4B,CAA/B,CAGD,CAND,CAQC;AAED,GAAM0C,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CAC5BC,KAAK,CAAC,MAAD,CAAL,CACCC,IADD,CACM,SAAAC,GAAG,CAAG,CACV,GAAGA,GAAG,CAACC,EAAP,CAAU,CACR,MAAOD,CAAAA,GAAG,CAACE,IAAJ,EAAP,CACD,CACF,CALD,EAKGH,IALH,CAKQ,SAAAI,YAAY,CAAI,CACtB3D,eAAe,CAAC2D,YAAD,CAAf,CACD,CAPD,EAQCC,KARD,CAQO,SAAAC,GAAG,QAAI5B,CAAAA,OAAO,CAAC6B,KAAR,CAAcD,GAAd,CAAJ,EARV,EASAzD,aAAa,CAAC,CAACD,UAAF,CAAb,CACA,GAAIA,UAAJ,CAAgBG,aAAa,CAAC,KAAD,CAAb,CACjB,CAZD,CAcA,GAAMyD,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CAC5BT,KAAK,CAAC,MAAD,CAAL,CACCC,IADD,CACM,SAAAC,GAAG,CAAG,CACV,GAAGA,GAAG,CAACC,EAAP,CAAU,CACR,MAAOD,CAAAA,GAAG,CAACE,IAAJ,EAAP,CACD,CACF,CALD,EAKGH,IALH,CAKQ,SAAAI,YAAY,CAAI,CACtB3D,eAAe,CAAC2D,YAAD,CAAf,CACD,CAPD,EAQCC,KARD,CAQO,SAAAC,GAAG,QAAI5B,CAAAA,OAAO,CAAC6B,KAAR,CAAcD,GAAd,CAAJ,EARV,EASAvD,aAAa,CAAC,CAACD,UAAF,CAAb,CACA,GAAIA,UAAJ,CAAgBD,aAAa,CAAC,KAAD,CAAb,CACjB,CAZD,CAeA,GAAM4D,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACC,IAAD,CAAMC,IAAN,CAAe,CAEhC,GAAIC,CAAAA,YAAY,CAAGC,IAAI,CAACC,KAAL,CAAWJ,IAAX,CAAnB,CACAvE,SAAS,CAACyE,YAAD,CAAT,CACArD,QAAQ,CAACoD,IAAD,CAAR,CACAtD,QAAQ,CAAC,GAAKsD,IAAL,CAAY,IAAb,CAAR,CACAH,eAAe,GAChB,CAPD,CASA,mBACE,oBAAC,QAAD,EAAU,KAAK,CACb,CACErF,QAAQ,CAAEA,QADZ,CAEEiC,KAAK,CAAEA,KAFT,CAGEZ,YAAY,CAAEA,YAHhB,CAIET,WAAW,CAAEA,WAJf,CAKEe,UAAU,CAAEA,UALd,CAMEF,UAAU,CAAEA,UANd,CAOEU,KAAK,CAAEA,KAPT,CAQE/B,MAAM,CAAEA,MARV,CASEe,YAAY,CAAEA,YAThB,CAUEkB,MAAM,CAAEA,MAVV,CAWEuD,OAAO,CAAE,CACPhD,WAAW,CAAEA,WADN,CAEPF,eAAe,CAAEA,eAFV,CAGP0B,eAAe,CAAGA,eAHX,CAIPvB,kBAAkB,CAAEA,kBAJb,CAKPyB,WAAW,CAAEA,WALN,CAMPG,YAAY,CAAEA,YANP,CAOPa,UAAU,CAAGA,UAPN,CAQP5B,YAAY,CAAEA,YARP,CASPK,WAAW,CAAEA,WATN,CAUPsB,eAAe,CAAEA,eAVV,CAWPV,eAAe,CAAEA,eAXV,CAYPd,YAAY,CAAEA,YAZP,CAaPa,eAAe,CAAEA,eAbV,CAcPV,YAAY,CAAEA,YAdP,CAePhB,gBAAgB,CAAEA,gBAfX,CAXX,CADF,eAgCE,2BAAK,SAAS,CAAC,KAAf,eACI,oBAAC,IAAD,MADJ,CAhCF,CADF,CAsCD,CAED,cAAepD,CAAAA,GAAf","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { Provider } from './components/Context'\nimport useSound from 'use-sound'\nimport notes from './../src/sounds/all-instruments.mp3'\nimport './App.css';\nimport Main from './components/Main/Main.js'\n\n\nfunction App() {\n\n  // creating the scale & beat constants\n  const BEATS = 16\n  const SCALES = ['C2', 'D2', 'E2', 'G2', 'C3', 'D3', 'E3', 'G3', 'C4', 'D4', 'E4']\n\n  // creating the BeatBar \n  const getBeatCpts = () => {\n    let beatCpts = []\n    for (let i = 0; i < BEATS; i++) {\n      beatCpts.push(i)\n    }\n    return beatCpts\n  }\n\n  const beatCpts = getBeatCpts()\n\n   // creating the SoundBoard\n\n  const getSoundPoints = () => {\n    let sounds = []\n    for (let i = 0; i < SCALES.length; i++) {\n      sounds.push([])\n      for (let j = 0; j < BEATS; j++) {\n        sounds[i].push({\n          i: i, j: j, scale: SCALES[i],\n          activeInstruments:  {}\n        })\n      }\n    }\n    return sounds\n  }\n\n\n  // assigning names and intervals for the sounds in the mp3 file\n\n  const  getSprites = () => {\n    let count = -1000\n    let sprites = {}\n    instruments.forEach( instrument => {\n      ( SCALES.forEach(scale => {\n        sprites[instrument.name + scale] =  [count += 1000, 1000]  \n      }))\n    })\n    return sprites\n  }\n\n  // initializing some varibales with HOOKS\n\n  const [sounds, setSounds] = useState(getSoundPoints())\n  const [activeSounds, setActiveSounds] = useState([])\n  const [redBeatIndex, setRedBeatIndex] = useState(-1)\n  // const [render, setRender] = useState(0)\n  const [initialState,setInitialState] = useState([])\n  const [instruments, setInstruments] = useState([\n    { name: 'saxophone', checked: true },\n    { name: 'cello', checked: false },\n    { name: 'oboe', checked: false },\n    { name: 'vocal', checked: false },\n    { name: 'guitar', checked: false },\n    { name: 'kora', checked: false },\n    { name: 'vibraphone', checked: false },\n    { name: 'drums', checked: false },\n    { name: 'violin', checked: false}\n  ])\n  const [isShowSave, setIsShowSave] = useState(false)\n  const [isShowLoad, setIsShowLoad] = useState(false)\n  const [isPlay, setIsPlay] = useState(false)\n  const [isPause, setIsPause] = useState(false)\n  const [delay, setDelay] = useState(1000)\n  const [tempo, setTempo] = useState(60)\n  const [volume, setVolume] = useState(0.75)\n\n    // the useSound HOOK !!\n  const [play] = useSound(notes, {\n    volume: volume,\n    sprite: getSprites(),\n    interrupt: false\n  })\n\n  // functions for the Instrument Bar\n\n  const checkInstrument = name => {\n    setInstruments(instruments.map(instrument => (instrument.name === name) ? { ...instrument, checked: true } : { ...instrument, checked: false }))\n  }\n\n\n  // functions for the Beat Bar\n  const assignColor = i => {\n    if (!isPlay && !isPause) return\n    return i === redBeatIndex ? 'red' : ''\n  }\n\n  // functions for the Sound Board\n\n  const handleClickedSound = (i, j, instrument) => {\n    setSounds(\n      sounds.map(soundRow =>\n        soundRow.map(sound => (sound.i === i && sound.j === j) ? { ...sound, activeInstruments: { ...sound.activeInstruments, [instrument]: !sound.activeInstruments[instrument] } } : sound\n        ))\n    )\n  }\n\n  const assignSoundClass = (i, j, instrument) => {\n    let currSoundInstrument = sounds[i][j].activeInstruments[instrument]\n    return (currSoundInstrument === true) ? 'active' : ''\n  }\n\n\n  \n\n\n\n\n  // const toggleMute = () => {\n  //   console.log('let mute!')\n  //   let volumeSliderValue = document.getElementById('volume-slider').value\n  //   if (volumeSliderValue !== 0) {\n  //     volumeSliderValue = 0\n  //     document.querySelector('.mute').classList.remove('hidden')\n  //     setRender(render+1)\n  //   } else {\n  //     volumeSliderValue = 0.75\n  //     document.querySelector('.mute').classList.add('hidden')\n  //     setRender(render+1)\n  //   }\n  // }\n\n\n\n  const playSounds = () => {\n\n    if (isPlay) {\n\n      let currentActives = activeSounds.filter(sound => sound.j === redBeatIndex)\n      // console.log('current actives: ',currentActives)\n      currentActives.forEach(sound => {\n        for (let instrument in sound.activeInstruments) {\n          // console.log('instrument status: ', sound.activeInstruments[instrument])\n          if (sound.activeInstruments[instrument] === true) play({id: instrument + sound.scale})\n        }\n      })\n    }\n  }\n\n  // USE EFFECT! all the stuff that renders on each change of the usestates in the brackets below\n  useEffect(() => {\n    let actives = []\n    sounds.forEach(soundRow => soundRow.forEach(sound => {\n      for (let instrument in (sound.activeInstruments)){\n        if (sound.activeInstruments[instrument]) actives.push(sound)\n      }\n    }))\n    setActiveSounds(actives) \n    // fetch('/api')\n    // .then(res=> {\n    //   if(res.ok){\n    //     return res.json()\n    //   }\n    // }).then(jsonResponse => {\n    //   setInitialState(jsonResponse)\n    // })\n    // .catch(err => console.error(err))\n    console.log('initial state: ',initialState)\n    console.log('active sounds @ useeffect: ', activeSounds)\n    playSounds()\n  }, [redBeatIndex, isPlay,isShowLoad,isShowSave])\n\n\n\n\n  // initializing the increment  with useRef (otherwise setInterval wont work properly)\n  const increment = useRef(null)\n  \n  // functions for the Control Buttons Bar\n  const startPlaying = () => {\n    if (isPlay) return\n    setIsPlay(true)\n    setIsPause(false)\n    increment.current = setInterval(() => {\n      setRedBeatIndex((redBeatIndex) => redBeatIndex === 15 ? 0 : redBeatIndex + 1)\n    }, delay)\n  }\n\n  const pausePlaying = () => {\n    if (!isPlay) return\n    clearInterval(increment.current);\n    setIsPlay(false)\n    setIsPause(true)\n  }\n\n  const stopPlaying = () => {\n    clearInterval(increment.current)\n    setIsPlay(false)\n    setIsPause(false)\n    setRedBeatIndex(-1)\n  }\n\n  const resetPlaying = () => {\n    clearInterval(increment.current)\n    setIsPlay(false)\n    setIsPause(false)\n    setRedBeatIndex(-1)\n    setDelay(1000)\n    setTempo(60)\n    document.getElementById('tempo-slider').value = 60\n    document.getElementById('volume-slider').value = 0.75\n    setVolume(0.75)\n    setSounds(getSoundPoints())\n    setActiveSounds([])\n  }\n\n  const clearInstrument = () => {\n    let currentInsrtumentName = instruments.filter(instrument => instrument.checked)[0].name\n    setSounds(sounds.map(soundRow => soundRow.map(\n      (sound => (sound.activeInstruments[currentInsrtumentName]) ? { ...sound, activeInstruments: { ...sound.activeInstruments, [currentInsrtumentName]: false } } : sound\n      )\n    )))\n  }\n\n\n  const handleTempo = ev => {\n    let value = ev.target.value\n    setTempo(value)\n    setDelay(60 / value * 1000)\n  }\n\n\n  const handleVolume = ev =>  {if (isPlay) setVolume(ev.target.value)}\n\n  const playUpdateTempo = () => {\n    if (!isPlay) return\n    clearInterval(increment.current);\n    increment.current = setInterval(() => {\n      setRedBeatIndex((redBeatIndex) => redBeatIndex === 15 ? 0 : redBeatIndex + 1)\n    }, delay)\n  }\n\n   // functions for saving & loading modals in the Control Buttons Bar\n\n  const toggleSaveModal = () => {\n    fetch('/api')\n    .then(res=> {\n      if(res.ok){\n        return res.json()\n      }\n    }).then(jsonResponse => {\n      setInitialState(jsonResponse)\n    })\n    .catch(err => console.error(err))\n    setIsShowSave(!isShowSave)\n    if (isShowSave) setIsShowLoad(false)\n  }\n\n  const toggleLoadModal = () => {\n    fetch('/api')\n    .then(res=> {\n      if(res.ok){\n        return res.json()\n      }\n    }).then(jsonResponse => {\n      setInitialState(jsonResponse)\n    })\n    .catch(err => console.error(err))\n    setIsShowLoad(!isShowLoad)\n    if (isShowLoad) setIsShowSave(false)\n  }\n  \n\n  const loadSounds = (snds,tmpo) => {\n\n    let parsedSounds = JSON.parse(snds)\n    setSounds(parsedSounds)\n    setTempo(tmpo)\n    setDelay(60 / tmpo * 1000)\n    toggleLoadModal()\n  }\n\n  return (\n    <Provider value={\n      {\n        beatCpts: beatCpts,\n        delay: delay,\n        initialState: initialState,\n        instruments: instruments,\n        isShowLoad: isShowLoad,\n        isShowSave: isShowSave,\n        tempo: tempo,\n        sounds: sounds,\n        redBeatIndex: redBeatIndex,\n        volume: volume,\n        actions: {\n          assignColor: assignColor,\n          checkInstrument: checkInstrument,\n          clearInstrument : clearInstrument,\n          handleClickedSound: handleClickedSound,\n          handleTempo: handleTempo,\n          handleVolume: handleVolume,\n          loadSounds : loadSounds,\n          startPlaying: startPlaying,\n          stopPlaying: stopPlaying,\n          toggleLoadModal: toggleLoadModal,\n          toggleSaveModal: toggleSaveModal,\n          pausePlaying: pausePlaying,\n          playUpdateTempo: playUpdateTempo,\n          resetPlaying: resetPlaying,\n          assignSoundClass: assignSoundClass\n        }\n      }\n    }>\n\n      <div className=\"App\">\n          <Main />\n      </div>\n    </Provider>\n  )\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}